from src.Models.{{ entity.nameEntity }}Entity import {{ entity.nameEntity }}Entity
from faker import Faker
from src import app, db

class {{ entity.nameEntity }}Mock:
    fake = Faker()
    fake.seed({{ entity.getRandomInt() }})
    {%- for step_var in ['DEFAULT', 'UPDATE'] %}
    {{ entity.nameEntity | upper }}_ENTITY_{{ entity.getPrimaryKey().nameColumn | upper }}_{{ step_var }}= fake.pyint()
    {% for column in entity.columns %}
    {{ entity.nameEntity | upper }}_ENTITY_{{ column.nameColumn | upper }}_{{ step_var }}=
    {%- if column.typeData == 'String' -%}
        fake.word()
    {%- elif column.typeData == 'Integer' -%}
        fake.pyint()
    {%- elif column.typeData == 'Numeric' -%}
        fake.pydecimal()
    {%- elif column.typeData == 'Float' -%}
        fake.pyfloat()
    {%- elif column.typeData == 'DateTime' -%}
        fake.date_time()
    {%- elif column.typeData == 'Boolean' -%}
        fake.pybool()
    {%- endif %}
    {%- endfor %}
    {%- endfor %}

    def createEntityWithoutRelationship(self) -> {{ entity.nameEntity }}Entity:
        {{ entity.nameEntity | lower }}Entity = {{ entity.nameEntity }}Entity()
        {{ entity.nameEntity | lower }}Entity.{{ entity.getPrimaryKey().nameColumn }} = self.{{ entity.nameEntity | upper }}_ENTITY_{{ entity.getPrimaryKey().nameColumn | upper }}_DEFAULT
        {%- for column in entity.columns %}
        {{ entity.nameEntity | lower }}Entity.{{ column.nameColumn }} = self.{{ entity.nameEntity | upper }}_ENTITY_{{ column.nameColumn | upper }}_DEFAULT
        {%- endfor %}
        return {{ entity.nameEntity | lower }}Entity

    def createEntityWithRelationship(self
        {%- for relationship in entity.relationships -%}    
            {%- if relationship.isOneToOne -%}
                {%- if relationship.entity1 == entity -%}
                    , {{ relationship.entity2.nameEntity | lower }} = None
                {%- else -%}
                    , {{ relationship.entity1.nameEntity | lower }} = None
                {%- endif -%}
            {%- elif relationship.isManyToOne -%}
                {%- if relationship.entity1 == entity -%}
                    , {{ relationship.entity2.nameEntity | lower }} = None
                {%- else -%}
                    , {{ relationship.entity1.nameEntity | lower }} = None
                {%- endif -%}
            {%- elif relationship.isOneToMany -%}
                {%- if relationship.entity1 == entity -%}
                    , {{ relationship.entity2.nameEntity | lower }} = None
                {%- else -%}
                    , {{ relationship.entity1.nameEntity | lower }} = None
                {%- endif -%}
            {%- else -%}
                {%- if relationship.entity1 == entity -%}
                    , {{ relationship.entity2.nameEntity | lower }} = None
                {%- else -%}
                    , {{ relationship.entity1.nameEntity | lower }} = None
                {%- endif -%}
            {%- endif -%}
        {%- endfor -%}
    ) -> {{ entity.nameEntity }}Entity:
        {%- for relationship in entity.relationships -%}    
        {%- if relationship.isOneToOne %}
            {%- if relationship.entity1 == entity %}
        from .{{ relationship.entity2.nameEntity }}Mock import {{ relationship.entity2.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity2.nameEntity }}Repository import {{ relationship.entity2.nameEntity }}Repository
                {%- else %}
        from .{{ relationship.entity1.nameEntity }}Mock import {{ relationship.entity1.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity1.nameEntity }}Repository import {{ relationship.entity1.nameEntity }}Repository
                {%- endif %}
            {%- elif relationship.isManyToOne %}
                {%- if relationship.entity1 == entity %}
        from .{{ relationship.entity2.nameEntity }}Mock import {{ relationship.entity2.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity2.nameEntity }}Repository import {{ relationship.entity2.nameEntity }}Repository
                {% else %}
        from .{{ relationship.entity1.nameEntity }}Mock import {{ relationship.entity1.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity1.nameEntity }}Repository import {{ relationship.entity1.nameEntity }}Repository
                {%- endif %}
            {%- elif relationship.isOneToMany %}
                {%- if relationship.entity1 == entity %}
        from .{{ relationship.entity2.nameEntity }}Mock import {{ relationship.entity2.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity2.nameEntity }}Repository import {{ relationship.entity2.nameEntity }}Repository
                {%- else %}
        from .{{ relationship.entity1.nameEntity }}Mock import {{ relationship.entity1.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity1.nameEntity }}Repository import {{ relationship.entity1.nameEntity }}Repository
                {%- endif %}
            {%- else %}
                {%- if relationship.entity1 == entity %}
        from .{{ relationship.entity2.nameEntity }}Mock import {{ relationship.entity2.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity2.nameEntity }}Repository import {{ relationship.entity2.nameEntity }}Repository
                {%- else %}
        from .{{ relationship.entity1.nameEntity }}Mock import {{ relationship.entity1.nameEntity }}Mock
        from src.Repositories.{{ relationship.entity1.nameEntity }}Repository import {{ relationship.entity1.nameEntity }}Repository
                {%- endif %}
            {%- endif %}
        {%- endfor %}
        entity = self.createEntityWithoutRelationship()
        {%- if entity.relationships | length > 0 %}
        with app.app_context():
            {%- for relationship in entity.relationships -%}    
            {%- if relationship.isOneToOne %}
            {%- if relationship.entity1 == entity %}
            if {{ relationship.entity2.nameEntity | lower }} == None:
                {{ relationship.entity2.nameEntity | lower }}Mock = {{ relationship.entity2.nameEntity }}Mock()
                {{ relationship.entity2.nameEntity | lower }}Repository = {{ relationship.entity2.nameEntity }}Repository()
                {{ relationship.entity2.nameEntity | lower }}Entity = {{ relationship.entity2.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity2.nameEntity | lower }}Repository.save({{ relationship.entity2.nameEntity | lower }}Entity)
                entity.{{ relationship.entity2.nameEntity | lower }} = {{ relationship.entity2.nameEntity | lower }}Entity
            else:
                entity.{{ relationship.entity2.nameEntity | lower }} = {{ relationship.entity2.nameEntity | lower }}
            {%- else %}
            if {{ relationship.entity1.nameEntity | lower }} == None:
                {{ relationship.entity1.nameEntity | lower }}Mock = {{ relationship.entity1.nameEntity }}Mock()
                {{ relationship.entity1.nameEntity | lower }}Repository = {{ relationship.entity1.nameEntity }}Repository()
                {{ relationship.entity1.nameEntity | lower }}Entity = {{ relationship.entity1.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity1.nameEntity | lower }}Repository.save({{ relationship.entity1.nameEntity | lower }}Entity)
                entity.{{ relationship.entity1.nameEntity | lower }}_{{ relationship.entity1.getPrimaryKey().nameColumn }} = {{ relationship.entity1.nameEntity | lower }}Entity.{{ relationship.entity1.getPrimaryKey().nameColumn }}
            else:
                entity.{{ relationship.entity1.nameEntity | lower }}_{{ relationship.entity1.getPrimaryKey().nameColumn }} = {{ relationship.entity1.nameEntity | lower }}.{{ relationship.entity1.getPrimaryKey().nameColumn }}
            {%- endif %}
            {%- elif relationship.isManyToOne %}
            {%- if relationship.entity1 == entity %}
            if {{ relationship.entity2.nameEntity | lower }} == None:
                {{ relationship.entity2.nameEntity | lower }}Mock = {{ relationship.entity2.nameEntity }}Mock()
                {{ relationship.entity2.nameEntity | lower }}Repository = {{ relationship.entity2.nameEntity }}Repository()
                {{ relationship.entity2.nameEntity | lower }}Entity = {{ relationship.entity2.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity2.nameEntity | lower }}Repository.save({{ relationship.entity2.nameEntity | lower }}Entity)
                entity.{{ relationship.entity2.nameEntity | lower }}_{{ relationship.entity2.getPrimaryKey().nameColumn }} = {{ relationship.entity2.nameEntity | lower }}Entity.{{ relationship.entity2.getPrimaryKey().nameColumn }}
            else:
                entity.{{ relationship.entity2.nameEntity | lower }}_{{ relationship.entity2.getPrimaryKey().nameColumn }} = {{ relationship.entity2.nameEntity | lower }}.{{ relationship.entity2.getPrimaryKey().nameColumn }}  
            {% else %}
            if {{ relationship.entity1.nameEntity | lower }} == None:
                {{ relationship.entity1.nameEntity | lower }}Mock = {{ relationship.entity1.nameEntity }}Mock()
                {{ relationship.entity1.nameEntity | lower }}Repository = {{ relationship.entity1.nameEntity }}Repository()
                {{ relationship.entity1.nameEntity | lower }}Entity = {{ relationship.entity1.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity1.nameEntity | lower }}Repository.save({{ relationship.entity1.nameEntity | lower }}Entity)
                {{ relationship.entity1.nameEntity | lower }} = {{ relationship.entity1.nameEntity | lower }}Entity
            entity.{{ relationship.entity1.nameEntity | lower }} = [{{ relationship.entity1.nameEntity | lower }}]
            {%- endif %}
            {%- elif relationship.isOneToMany %}
            {%- if relationship.entity1 == entity %}
            if {{ relationship.entity2.nameEntity | lower }} == None:
                {{ relationship.entity2.nameEntity | lower }}Mock = {{ relationship.entity2.nameEntity }}Mock()
                {{ relationship.entity2.nameEntity | lower }}Repository = {{ relationship.entity2.nameEntity }}Repository()
                {{ relationship.entity2.nameEntity | lower }}Entity = {{ relationship.entity2.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity2.nameEntity | lower }}Repository.save({{ relationship.entity2.nameEntity | lower }}Entity)
                {{ relationship.entity2.nameEntity | lower }} = {{ relationship.entity2.nameEntity | lower }}Entity
            entity.{{ relationship.entity2.nameEntity | lower }} = [{{ relationship.entity2.nameEntity | lower }}]
            {%- else %}
            if {{ relationship.entity1.nameEntity | lower }} == None:
                {{ relationship.entity1.nameEntity | lower }}Mock = {{ relationship.entity1.nameEntity }}Mock()
                {{ relationship.entity1.nameEntity | lower }}Repository = {{ relationship.entity1.nameEntity }}Repository()
                {{ relationship.entity1.nameEntity | lower }}Entity = {{ relationship.entity1.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity1.nameEntity | lower }}Repository.save({{ relationship.entity1.nameEntity | lower }}Entity)
                entity.{{ relationship.entity1.nameEntity | lower }}_{{ relationship.entity1.getPrimaryKey().nameColumn }} = {{ relationship.entity1.nameEntity | lower }}Entity.{{ relationship.entity1.getPrimaryKey().nameColumn }}
            else:
                entity.{{ relationship.entity1.nameEntity | lower }}_{{ relationship.entity1.getPrimaryKey().nameColumn }} = {{ relationship.entity1.nameEntity | lower }}.{{ relationship.entity1.getPrimaryKey().nameColumn }}
            {%- endif %}
            {%- else %}
            {%- if relationship.entity1 == entity %}
            if {{ relationship.entity2.nameEntity | lower }} == None:
                {{ relationship.entity2.nameEntity | lower }}Mock = {{ relationship.entity2.nameEntity }}Mock()
                {{ relationship.entity2.nameEntity | lower }}Repository = {{ relationship.entity2.nameEntity }}Repository()
                {{ relationship.entity2.nameEntity | lower }}Entity = {{ relationship.entity2.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity2.nameEntity | lower }}Repository.save({{ relationship.entity2.nameEntity | lower }}Entity)
                {{ relationship.entity2.nameEntity | lower }} = {{ relationship.entity2.nameEntity | lower }}Entity
            entity.{{ relationship.entity2.nameEntity | lower }} = [{{ relationship.entity2.nameEntity | lower }}]
            {%- else %}
            if {{ relationship.entity1.nameEntity | lower }} == None:
                {{ relationship.entity1.nameEntity | lower }}Mock = {{ relationship.entity1.nameEntity }}Mock()
                {{ relationship.entity1.nameEntity | lower }}Repository = {{ relationship.entity1.nameEntity }}Repository()
                {{ relationship.entity1.nameEntity | lower }}Entity = {{ relationship.entity1.nameEntity | lower }}Mock.createEntityWithRelationship({{ entity.nameEntity | lower }} = entity)
                # {{ relationship.entity1.nameEntity | lower }}Repository.save({{ relationship.entity1.nameEntity | lower }}Entity)
                {{ relationship.entity1.nameEntity | lower }} = {{ relationship.entity1.nameEntity | lower }}Entity
            entity.{{ relationship.entity1.nameEntity | lower }} = [{{ relationship.entity1.nameEntity | lower }}]
            {%- endif -%}
            {%- endif -%}
            {%- endfor %}
        {%- endif %}
        return entity

    def createMalformedEntity(self):
        return {{ entity.nameEntity }}Entity()